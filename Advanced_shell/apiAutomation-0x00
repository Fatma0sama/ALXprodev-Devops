#!/bin/bash

# Define the API endpoint and Pokémon name
POKEMON_NAME="pikachu"
API_URL="https://pokeapi.co/api/v2/pokemon/${POKEMON_NAME}"
DATA_FILE="data.json"
ERROR_FILE="errors.txt"

# Make the API request using curl and save the output
# The -s option makes curl silent (no progress meter or error messages)
# The -w option allows for checking the HTTP status code
HTTP_STATUS=$(curl -s -o "${DATA_FILE}" -w "%{http_code}" "${API_URL}")

# Check the HTTP status code
if [ "${HTTP_STATUS}" -eq 200 ]; then
    echo "Successfully retrieved data for ${POKEMON_NAME} and saved to ${DATA_FILE}"
elif [ "${HTTP_STATUS}" -eq 404 ]; then
    echo "$(date): Error - Pokémon '${POKEMON_NAME}' not found (404)." >> "${ERROR_FILE}"
    echo "API request failed. Error logged to ${ERROR_FILE}"
else
    echo "$(date): Error - Failed to fetch data from API. HTTP status code: ${HTTP_STATUS}" >> "${ERROR_FILE}"
    echo "API request failed. Error logged to ${ERROR_FILE}"
fi
